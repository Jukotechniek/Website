# bot_interface.py

import requests
from flask import Flask, request, jsonify
from flask import Response

app = Flask(__name__)

N8N_WEBHOOK_URL = "http://localhost:5678/webhook/test"  # Replace with your n8n webhook URL

@app.route('/trigger-n8n', methods=['POST'])
def trigger_n8n():
    data = request.json
    # Forward the data to n8n webhook
    response = requests.post(N8N_WEBHOOK_URL, json=data)
    return jsonify({
        "status": "forwarded",
        "n8n_response": response.json() if response.headers.get('Content-Type') == 'application/json' else response.text
    })

if __name__ == '__main__':
    # Import and register the WhatsApp webhook route

    @app.route('/webwhatsapp', methods=['POST'])
    def webwhatsapp():
        data = request.json
        # Here you would process the WhatsApp webhook payload as needed
        # For demonstration, just forward to n8n as well
        response = requests.post(N8N_WEBHOOK_URL, json=data)
        return jsonify({
            "status": "whatsapp_forwarded",
            "n8n_response": response.json() if response.headers.get('Content-Type') == 'application/json' else response.text
        })

    app.run(port=5000)